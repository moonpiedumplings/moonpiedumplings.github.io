<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-10-23">

<title>Jeffrey Fonseca - Building an ML pipeline</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jeffrey Fonseca</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../playground/index.html" rel="" target="">
 <span class="menu-text">Playground</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../guides/index.html" rel="" target="">
 <span class="menu-text">Guides</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/moonpiedumplings" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#selection-of-software-and-models" id="toc-selection-of-software-and-models" class="nav-link active" data-scroll-target="#selection-of-software-and-models">Selection of software and models</a>
  <ul class="collapse">
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a></li>
  <li><a href="#survey-software" id="toc-survey-software" class="nav-link" data-scroll-target="#survey-software">Survey Software</a>
  <ul class="collapse">
  <li><a href="#option-2-odoo-survey" id="toc-option-2-odoo-survey" class="nav-link" data-scroll-target="#option-2-odoo-survey">Option 2: Odoo Survey</a></li>
  <li><a href="#option-3-kobotoolbox" id="toc-option-3-kobotoolbox" class="nav-link" data-scroll-target="#option-3-kobotoolbox">Option 3: Kobotoolbox</a></li>
  <li><a href="#option-4-openforis-collect" id="toc-option-4-openforis-collect" class="nav-link" data-scroll-target="#option-4-openforis-collect">Option 4: OpenForis Collect</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Building an ML pipeline</h1>
  <div class="quarto-categories">
    <div class="quarto-category">linux</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>For my Black Studies and Culture class (AFRS 100), the class mainly consists of a single major project, which we are given free reign about. So obviously, I made mine related to computer science.</p>
<p>There is a very good documentary, called “Coded Bias”, on Netflix. In it, MIT researcher Joy Buolamwini discovers that existing facial recognition AI struggle to differentiate black people properly, or sometimes to even recognize them as a face.</p>
<p>The film also goes further in depth, like how facial recognition is being increasingly used to surveil populations. It gives the example of in the UK, where a facial recognition AI is employed to catch “criminals,” but the AI has the same issue of not being able to differentiate between black people, which leads to innocent people being accosted.</p>
<p>Of course, innocent white people also got accosted by this system. And there were also people who sought to protect their own face, but then were pulled over simply for desiring privacy. However, black people are definitely affected worse than other groups by systems such as this. The combination of the sheer apathy towards marginalized groups in the creation of facial recognition AI, and the already existing racism present in policing systems multiplies to create something much worse. Now, when the officer pulls you over, it’s not because they thought you “looked like a criminal”, it’s because the uncaring, unchallengeable AI said you “matched a criminal on the database.”</p>
<p>My research question is simple: Is this bias in facial recognition AI (specifically, the popular, public models) still the case?</p>
<p>To test this, I have a research plan.</p>
<p>Using my own server, I will download, existing, pretrained facial recognition models (models are like the learned information that drives AI), and maybe their datasets (data, like images, used to train AI), from <a href="https://www.kaggle.com/">kaggle</a> and <a href="https://huggingface.co/">huggingface</a>, two of the popular sites for public AI models.</p>
<p>I will then use a survey, and ask people to take pictures of their face from multiple angles. These images will be attached to a pseudo anonymous identifier. In addition to this, I will ask people to report their race as other people would view them.</p>
<p>After I have collected this information, I will attempt to use facial recognition on the images I have collected, checking the accuracy of matching them to the images. Using this, I can see how biased the facial recognition of some of the popular publicly available facial recognition models are.</p>
<section id="selection-of-software-and-models" class="level1">
<h1>Selection of software and models</h1>
<section id="models" class="level2">
<h2 class="anchored" data-anchor-id="models">Models</h2>
<p>For now, this is just some research on available public models.</p>
<p><a href="https://hackernoon.com/6-best-open-source-projects-for-real-time-face-recognition-vr1w34x5">hackernoon</a> article, <a href="https://web.archive.org/web/20230423202315/https://hackernoon.com/6-best-open-source-projects-for-real-time-face-recognition-vr1w34x5">archive</a>.</p>
<p><a href="https://github.com/ageitgey/face_recognition" class="uri">https://github.com/ageitgey/face_recognition</a> : Machine learning based python facial recognition library.</p>
</section>
<section id="survey-software" class="level2">
<h2 class="anchored" data-anchor-id="survey-software">Survey Software</h2>
<p>I need a survey software that integrates with the transformers that I will be running. They must be FOSS, and run entirely on my machines, for privacy reasons.</p>
<p>### Option 1: Limesurvey:</p>
<p><a href="https://github.com/LimeSurvey/LimeSurvey" class="uri">https://github.com/LimeSurvey/LimeSurvey</a></p>
<p>Many of the docker images seem to be a bit outdated, and I can’t find an official one.</p>
<p>Thankfully, there exists a Nixos <a href="https://search.nixos.org/packages?channel=23.05&amp;show=limesurvey&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=limesurvey">package</a> and <a href="https://search.nixos.org/options?channel=23.05&amp;show=limesurvey&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=limesurvey">service</a> for it, meaning that will be fairly easy to deploy.</p>
<p>It supports <a href="https://manual.limesurvey.org/Question_type_-_File_upload">file upload</a>, but no image upload.</p>
<p>This one also has a python library to interact with it, so I can import data straight from there and plug it into a ML model.</p>
<section id="option-2-odoo-survey" class="level3">
<h3 class="anchored" data-anchor-id="option-2-odoo-survey">Option 2: Odoo Survey</h3>
<p><a href="https://github.com/odoo/odoo" class="uri">https://github.com/odoo/odoo</a></p>
<p>There also exists a <a href="https://search.nixos.org/options?channel=23.05&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=odoo">Nixos service</a> for this.</p>
<p>I don’t know if it supports images. See <a href="https://www.odoo.com/documentation/16.0/applications/marketing/surveys/create.html">docs</a></p>
</section>
<section id="option-3-kobotoolbox" class="level3">
<h3 class="anchored" data-anchor-id="option-3-kobotoolbox">Option 3: Kobotoolbox</h3>
<p>Github Organization: <a href="https://github.com/kobotoolbox" class="uri">https://github.com/kobotoolbox</a></p>
<p>They do have a docker container on there. No nix packages though, but that’s ok.</p>
<p>They do support the <a href="https://support.kobotoolbox.org/photo_audio_video_file.html?highlight=image">photo</a> image type.</p>
<p>There is an unofficial python api: <a href="https://pypi.org/project/pykobo/" class="uri">https://pypi.org/project/pykobo/</a>. However, it import data as a pandas dataframe, and I don’t know if it is possible to store images in those.</p>
</section>
<section id="option-4-openforis-collect" class="level3">
<h3 class="anchored" data-anchor-id="option-4-openforis-collect">Option 4: OpenForis Collect</h3>
<p>Has a <a href="https://openforis.org/tools/collect-mobile/">mobile app</a>, which can request users to take a photo. Only available on android.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>